<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ratio splitter</title>
  <style>
    :root{
      --bg:#ffffff; --fg:#000000; --muted:#333333; --card:#f5f7fb;
      --blue:#1e88e5; /* left */
      --yellow:#ffd54f; /* right */
      --border:#0c1024; --divider:#000; --panel:#fafafa;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{max-width:960px;margin:28px auto;padding:0 16px}

    header{display:flex;align-items:center;justify-content:center;margin-bottom:14px}
    header h1{font-size:26px;margin:0 0 4px 0;color:#000000}

    .card{background:#fff;border:1px solid #e3e6ef;border-radius:16px;box-shadow:0 6px 22px rgba(0,0,0,.06)}

    .controls{display:flex;flex-wrap:wrap;gap:10px;align-items:center;padding:14px}
    .controls .btn{appearance:none;border:1px solid #bbb;background:#fff;color:#111;
      padding:9px 14px;border-radius:12px;cursor:pointer}
    .controls .btn[disabled]{opacity:.45;cursor:not-allowed}
    .controls .btn:hover:not([disabled]){background:#f6f6f6}
    .controls .btn:active:not([disabled]){transform:translateY(1px)}
    .controls .btn.primary{border-color:#888}
    .controls .info{margin-left:auto;color:#444;font-size:13px}

    .viz{padding:18px 16px 8px}

    .counters{position:relative;display:flex;gap:0;margin-bottom:8px}
    .counter-slot{flex:1;display:flex;justify-content:center}
    .counter{width:88px;max-width:90%; text-align:center; padding:10px 12px; border-radius:10px; border:1px solid #bbbbbb; background:#ffffff; color:#000000; font-size:32px; font-weight:600}

    .barWrap{position:relative;border-radius:16px;border:3px solid #0f1328;background:#0b1020;padding:12px}
    .bar{position:relative;height:56px;border-radius:10px;overflow:visible;background:#0b0f24;border:2px solid var(--border)}
    .bar .leftFill, .bar .rightFill{position:absolute;top:0;bottom:0;z-index:1}
    .bar .leftFill{left:0;background:var(--blue)}
    .bar .rightFill{right:0;background:var(--yellow)}

    .bar .lines{position:absolute;inset:0;pointer-events:none;z-index:2}
    .bar .lines .v{position:absolute;top:0;bottom:0;width:1px;background:#000}

    .bar .labels{position:absolute;inset:0;pointer-events:none;display:flex;align-items:stretch;z-index:3}
    .bar .labels .cell{flex:1;display:flex;align-items:center;justify-content:center;font-weight:700;}

    .handle{position:absolute;bottom:-34px;transform:translateX(-50%);width:0;height:0;pointer-events:auto;z-index:4}
    .handle .tab{position:absolute;left:50%;transform:translateX(-50%);top:-16px;width:38px;height:16px;background:#141724;border:2px solid #0e1220;border-bottom:none;border-radius:4px 4px 0 0;box-shadow:0 2px 0 rgba(0,0,0,.25)}
    .handle .tip{position:absolute;left:50%;transform:translateX(-50%);top:0;width:0;height:0;border-left:18px solid transparent;border-right:18px solid transparent;border-top:24px solid #141724;filter:drop-shadow(0 2px 0 rgba(0,0,0,.25))}
    .handle{cursor:grab}
    .handle[aria-grabbed="true"]{cursor:grabbing}

    .ratio{margin-top:10px;display:flex;justify-content:center}
    .ratio input{width:220px;text-align:center;padding:10px 12px;border-radius:10px;border:1px solid #bbbbbb;background:#ffffff;color:#000000;font-size:32px;font-weight:600}

    .divideCtrl{
      margin-top:16px;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:14px;
      flex-wrap:wrap;
    }
    .divideText{
      font-size:16px;
      font-weight:600;
      color:#222;
      text-align:center;
    }
    .divideBtn{
      background:#22c55e;
      border-color:#16a34a;
      color:#ffffff;
      font-weight:700;
      font-size:16px;
      padding:12px 24px;
      border-radius:999px;
      box-shadow:0 4px 10px rgba(34,197,94,0.35);
    }
    .divideBtn:hover:not([disabled]){
      background:#16a34a;
    }

    .dividePanel{margin-top:10px; padding:12px; border:1px solid #e3e6ef; border-radius:12px; background:#fafafa; color:#111;}
    .dividePanel .msg{color:#b00020; font-size:13px;}

    .summary-main{
      margin-top:12px;
      text-align:center;
      font-weight:600;
      font-size:20px;
      color:#14532d;
    }
    .summary-answer{
      margin-top:6px;
      text-align:center;
      font-weight:800;
      font-size:32px;
      color:#0f766e;
    }
    .foot{color:#555;font-size:12px;text-align:center;margin:10px 0 4px}
  </style>
</head>
<body>
  <div class="wrap">
    <header><h1>Ratio splitter</h1></header>

    <section class="card controls">
      <button class="btn primary" id="splitBtn">Split</button>
      <button class="btn" id="regroupBtn">Re-group</button>
      <button class="btn" id="resetBtn">Reset</button>
      <div class="info" id="partsInfo">Parts: 1 (max 256)</div>
    </section>

    <section class="card viz">
      <div class="counters">
        <div class="counter-slot"><input class="counter" id="leftCount" value="1" readonly></div>
        <div class="counter-slot"><input class="counter" id="rightCount" value="0" readonly></div>
      </div>

      <div class="barWrap">
        <div class="bar" id="bar">
          <div class="leftFill" id="leftFill" style="width:100%"></div>
          <div class="rightFill" id="rightFill" style="width:0%"></div>
          <div class="lines" id="lines"></div>
          <div class="labels" id="labels"></div>
          <div class="handle" id="handle">
            <div class="tab"></div>
            <div class="tip"></div>
          </div>
        </div>
      </div>

      <div class="ratio"><input id="ratioBox" value="1:0" readonly></div>

      <div class="divideCtrl">
        <div class="divideText">Click here to divide a quantity into this ratio</div>
        <button id="divideToggle" class="divideBtn">Click here to divide</button>
      </div>

      <section id="dividePanel" class="dividePanel" hidden>
        <div style="display:flex; gap:10px; align-items:center;">
          <label>Enter number to divide</label>
          <input id="divideInput" type="number" min="1" style="width:130px;">
          <span id="divideMsg" class="msg"></span>
        </div>
        <div id="divideSummary"></div>
      </section>

      <div class="foot">Keyboard: ←/→ (Shift = ×5). Max parts: 256.</div>
    </section>
  </div>

<script>
(function(){

  const MAX_PARTS = 256;
  const clamp = (v,min,max)=> Math.max(min, Math.min(max,v));
  const gcd=(a,b)=>{a=Math.abs(a);b=Math.abs(b);while(b){[a,b]=[b,a%b]}return a};
  const round1 = (x)=>Number(x.toFixed(1));

  // Sounds
  const dragSound = new Audio("drag.wav");
  const splitSound = new Audio("split.wav");
  const regroupSound = new Audio("regroup.wav");
  const resetSound = new Audio("reset.wav");

  function play(x){
    if(!x) return;
    x.currentTime=0;
    x.play().catch(()=>{});
  }

  // State
  let parts = 1;
  let leftCount = 1;
  let previousLeftCount = leftCount;
  let dragging = false;

  // Elements
  const bar = document.getElementById("bar");
  const handle = document.getElementById("handle");
  const leftFill = document.getElementById("leftFill");
  const rightFill = document.getElementById("rightFill");
  const lines = document.getElementById("lines");
  const labels = document.getElementById("labels");
  const leftBox = document.getElementById("leftCount");
  const rightBox = document.getElementById("rightCount");
  const ratioBox = document.getElementById("ratioBox");
  const partsInfo = document.getElementById("partsInfo");

  const splitBtn = document.getElementById("splitBtn");
  const regroupBtn = document.getElementById("regroupBtn");
  const resetBtn = document.getElementById("resetBtn");

  const divideToggle = document.getElementById("divideToggle");
  const dividePanel = document.getElementById("dividePanel");
  const divideInput = document.getElementById("divideInput");
  const divideMsg = document.getElementById("divideMsg");
  const divideSummary = document.getElementById("divideSummary");

  function counts(){
    return {L:leftCount, R:parts-leftCount};
  }

  function baseUnit(){
    const {L,R} = counts();
    const g = gcd(L,R);
    return {a0:L/g, b0:R/g, S:(L/g + R/g), g};
  }

  function updateLines(){
    lines.innerHTML="";
    for(let i=1;i<parts;i++){
      const v=document.createElement("div");
      v.className="v";
      v.style.left = (i/parts*100)+"%";
      lines.appendChild(v);
    }
  }

  function updateHandle(){
    const pct = leftCount/parts*100;
    handle.style.left = pct+"%";
    leftFill.style.width = pct+"%";
    rightFill.style.width = (100-pct)+"%";

    const {L,R}=counts();
    leftBox.value=L;
    rightBox.value=R;
    ratioBox.value=L+":"+R;
  }

  function updateButtons(){
    const {S,g} = baseUnit();
    splitBtn.disabled = (S<=0 || parts+S>MAX_PARTS);
    regroupBtn.disabled = !(g>=2 && parts-S>=1);
    partsInfo.textContent = "Parts: "+parts+" (max 256)";
  }

  function refresh(){
    updateLines();
    updateHandle();
    updateButtons();
    updateDivideUI();
  }

  function positionToLeftCount(x){
    const r = bar.getBoundingClientRect();
    const rel = clamp(x - r.left, 0, r.width);
    return clamp(Math.round(rel / r.width * parts), 0, parts);
  }

  handle.addEventListener("pointerdown", e=>{
    e.preventDefault();
    handle.setPointerCapture(e.pointerId);
    dragging=true;
    previousLeftCount=leftCount;
  });

  window.addEventListener("pointerup", ()=>{
    dragging=false;
  });

  window.addEventListener("pointermove", e=>{
    if(!dragging) return;
    const newLeft = positionToLeftCount(e.clientX);
    if(newLeft !== leftCount){
      leftCount=newLeft;
      play(dragSound);
    }
    refresh();
  });

  bar.addEventListener("pointerdown", e=>{
    if(e.target.closest("#handle")) return;
    leftCount = positionToLeftCount(e.clientX);
    refresh();
  });

  splitBtn.addEventListener("click", ()=>{
    const {a0,S} = baseUnit();
    if(parts+S<=MAX_PARTS){
      leftCount += a0;
      parts += S;
      refresh();
      play(splitSound);
    }
  });

  regroupBtn.addEventListener("click", ()=>{
    const {a0,S,g} = baseUnit();
    if(g>=2 && parts-S>=1){
      leftCount -= a0;
      parts -= S;
      refresh();
      play(regroupSound);
    }
  });

  resetBtn.addEventListener("click", ()=>{
    parts = 1;
    leftCount = 1;
    divideInput.value="";
    divideMsg.textContent="";
    divideSummary.textContent="";
    dividePanel.hidden=true;
    labels.innerHTML="";
    refresh();
    play(resetSound);
  });

  function updateDivideUI(){
    if(dividePanel.hidden){
      divideSummary.textContent="";
      labels.innerHTML="";
      return;
    }
    const v = Number(divideInput.value);
    if(!Number.isInteger(v) || v<=0){
      divideMsg.textContent="Enter a positive whole number.";
      divideSummary.textContent="";
      return;
    }
    divideMsg.textContent="";
    const {L,R}=counts();
    const per = v/parts;
    const leftVal = round1(per*L);
    const rightVal = round1(v-leftVal);

    divideSummary.innerHTML =
      `<div class="summary-main">${v} divided into the ratio ${L}:${R} is</div>
       <div class="summary-answer">${leftVal}:${rightVal}</div>`;
  }

  divideToggle.addEventListener("click", ()=>{
    dividePanel.hidden = !dividePanel.hidden;
    updateDivideUI();
  });

  divideInput.addEventListener("input", updateDivideUI);

  refresh();

})();
</script>

</body>
</html>
